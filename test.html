<!DOCTYPE html>
<html>

<head>
    <title>Test Scene</title>
    <meta charset="UTF-8">

    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.misc.min.js"></script>
    <script src="https://unpkg.com/super-hands@^3.0.3/dist/super-hands.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.min.js"></script>
</head>

<script src="helper_functions.js"></script>
<script>
    let timeToSpawn = randomRange(2, 10);
    let timer = setInterval(function () {
        timeToSpawn--;
    }, 1000);

    AFRAME.registerComponent("spheregenerator", {
    init: function () {
        this.el.addEventListener('click', function(){
            let scene = document.querySelector("#scene");
            let newSphere = document.createElement('a-sphere');
            
            newSphere.setAttribute('color', 'yellow');
            newSphere.setAttribute('scale', '0.3 0.3 0.3');
            newSphere.setAttribute('rotation', `${Math.random()*180} ${Math.random()*180} ${Math.random()*180}`)
            let newX = Math.random() * 2 - 1;
            newSphere.setAttribute("position", `${newX} 5 -3`);
            newSphere.setAttribute("dynamic-body", "shape:sphere");
            scene.appendChild(newSphere);
        });
    },
    tick: function () {
        if(timeToSpawn <= 0){
            let scene = document.querySelector("#scene");
            let newSphere = document.createElement('a-sphere');

            newSphere.setAttribute('color', 'yellow');
            newSphere.setAttribute('scale', '0.3 0.3 0.3');
            newSphere.setAttribute('rotation', `${Math.random()*180} ${Math.random()*180} ${Math.random()*180}`)

            let newX = Math.random() * 2 - 1;
            newSphere.setAttribute("position", `${newX} 5 -3`);
            newSphere.setAttribute("dynamic-body", "shape:sphere");
            scene.appendChild(newSphere);
            timeToSpawn = randomRange(2, 10);
        }
    },
});
</script>

<body>
    <a-scene id="scene" physics="debug:true">
        <a-camera><a-cursor></a-cursor></a-camera>
        <a-entity super-hands id="leftHand" hand-controls="hand: left; handModelStyle: lowPoly;" static-body="shape: sphere; sphereRadius: 0.02;" sphere-collider="objects: .interactable"></a-entity>
        <a-entity super-hands id="rightHand" hand-controls="hand: right; handModelStyle: lowPoly;" static-body="shape: sphere; sphereRadius: 0.02;" sphere-collider="objects: .interactable"></a-entity>

        <a-entity grabbable gltf-model="assets/katana/katana.gltf" position="0 1 -0.5" scale="0.35 0.35 0.35" rotation="0 180 0" class="interactable"></a-entity>
        <a-plane color="grey" rotation="-90 0 0" scale="20 20 20" static-body></a-plane>
        <a-box spheregenerator color="red" scale="0.5 0.5 0.5" position="0 2 -2" grabbable></a-box>
    </a-scene>
</body>

</html>